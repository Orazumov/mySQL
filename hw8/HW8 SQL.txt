1. Подсчитать общее количество лайков, которые получили 10 самых молодых пользователей.

SELECT SUM(likes_number) FROM (

SELECT  COUNT(l.target_id) as likes_number
FROM profiles p 
	 LEFT JOIN likes l
	 ON p.user_id = l.target_id AND l.target_type_id = 2

  GROUP BY p.user_id

ORDER BY p.birthday DESC
LIMIT 10
) as number_of_likes 
;

2. Определить кто больше поставил лайков (всего) - мужчины или женщины?

   SELECT p.gender, COUNT(*) as total 
   FROM likes l
   JOIN profiles p
   	 ON p.user_id = l.user_id
   GROUP BY gender
   ORDER BY total DESC
   LIMIT 2;  


3. Найти 10 пользователей, которые проявляют наименьшую активность в использовании социальной сети.

SELECT   
  CONCAT(first_name, ' ', last_name) AS user, (COUNT(DISTINCT l.user_id) + COUNT(DISTINCT med.user_id) + COUNT(DISTINCT mes.from_user_id)) as activity 
	  FROM users u
	  LEFT JOIN likes l
	  	ON l.user_id = u.id
	  LEFT JOIN media med
	    ON med.user_id = u.id
	  LEFT JOIN messages mes
	    ON mes.from_user_id = u.id
	  GROUP BY u.id 
	  ORDER BY activity
	  LIMIT 10;

